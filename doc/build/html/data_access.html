

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Data Access Overview &mdash; PyDataSource 0.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="PyDataSource 0.0.0 documentation" href="index.html"/>
        <link rel="next" title="Data Processing" href="data_processing.html"/>
        <link rel="prev" title="Welcome to PyDataSource’s documentation!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> PyDataSource
          

          
          </a>

          
            
            
              <div class="version">
                0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data Access Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#analysis-environment">Analysis Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-source">Data Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="#calibrated-area-detector">Calibrated Area Detector</a></li>
<li class="toctree-l2"><a class="reference internal" href="#event-iteration">Event Iteration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#event-codes">Event Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#beamline-data">Beamline Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#epics-data">Epics Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#waveform-detectors">Waveform Detectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#anlyzing-scans">Anlyzing Scans</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reloading-datasource">Reloading DataSource</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jump-quickly-to-specific-event">Jump Quickly to Specific Event</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data_processing.html">Data Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="xarray.html">Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_summary.html">Summarizing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="config_data.html">Configuration Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="build_html.html">Run Summary Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="exp_summary.html">Experiment Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch.html">Submitting Batch Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="conda.html">Conda Release System</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">PyDatSource API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyDataSource</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Data Access Overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/data_access.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="data-access-overview">
<span id="data-access"></span><h1>Data Access Overview<a class="headerlink" href="#data-access-overview" title="Permalink to this headline">¶</a></h1>
<p>The <strong>PyDataSource</strong> package provides access to LCLS event data by wrapping the psana “Detector” interface.  This page provides a quick introduction to basic event data access.  See other pages and the API section for futher details and options.</p>
<div class="section" id="analysis-environment">
<h2>Analysis Environment<a class="headerlink" href="#analysis-environment" title="Permalink to this headline">¶</a></h2>
<p>Use the following environment Setup from psana machine.  Start ipython with the –pylab option (or if youy prefer import numpy and matplotlib as needed).</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>.  /reg/g/psdm/etc/psconda.sh
ipython --pylab
</pre></div>
</div>
</div>
<div class="section" id="data-source">
<h2>Data Source<a class="headerlink" href="#data-source" title="Permalink to this headline">¶</a></h2>
<p>Use run and exp keywords to access your data using <strong>PyDataSource.DataSource</strong>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">PyDataSource</span>

<span class="gp">In [2]: </span><span class="n">ds</span> <span class="o">=</span> <span class="n">PyDataSource</span><span class="o">.</span><span class="n">DataSource</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="s1">&#39;xpptut15&#39;</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="mi">54</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-2-1bfe009d6780&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">ds</span> <span class="o">=</span> <span class="n">PyDataSource</span><span class="o">.</span><span class="n">DataSource</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="s1">&#39;xpptut15&#39;</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="mi">54</span><span class="p">)</span>

<span class="nn">/reg/neh/home4/koglin/conda/arch/x86_64-rhel7-gcc48-opt/python/PyDataSource/PyDataSource.pyc</span> in <span class="ni">__init__</span><span class="nt">(self, data_source, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">697</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_default_modules</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">path</span><span class="p">})</span>
<span class="g g-Whitespace">    </span><span class="mi">698</span>         <span class="c1">#self._default_modules.update({&#39;path&#39;: os.path.join(path,&#39;detectors&#39;)})</span>
<span class="ne">--&gt; </span><span class="mi">699</span>         <span class="bp">self</span><span class="o">.</span><span class="n">load_run</span><span class="p">(</span><span class="n">data_source</span><span class="o">=</span><span class="n">data_source</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">700</span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">smd</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">701</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_load_smd_config</span><span class="p">()</span>

<span class="nn">/reg/neh/home4/koglin/conda/arch/x86_64-rhel7-gcc48-opt/python/PyDataSource/PyDataSource.pyc</span> in <span class="ni">load_run</span><span class="nt">(self, data_source, reload, try_idx, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">791</span>         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">monshmserver</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ds</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">792</span>             <span class="k">if</span> <span class="bp">True</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">793</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">_ds</span> <span class="o">=</span> <span class="n">psana</span><span class="o">.</span><span class="n">DataSource</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_source</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">794</span>                 <span class="n">_key_info</span><span class="p">,</span> <span class="n">_modules</span> <span class="o">=</span> <span class="n">get_keys</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ds</span><span class="o">.</span><span class="n">env</span><span class="p">()</span><span class="o">.</span><span class="n">configStore</span><span class="p">())</span>
<span class="g g-Whitespace">    </span><span class="mi">795</span>                 <span class="k">if</span> <span class="s1">&#39;Partition&#39;</span> <span class="ow">in</span> <span class="n">_modules</span><span class="p">:</span>

<span class="nn">/reg/g/psdm/sw/conda/inst/miniconda2-prod-rhel7/envs/ana-1.3.11/lib/python2.7/site-packages/psana/datasource.pyc</span> in <span class="ni">DataSource</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span> 
<span class="g g-Whitespace">     </span><span class="mi">64</span>     <span class="c1"># Create the PSANA datasource object</span>
<span class="ne">---&gt; </span><span class="mi">65</span>     <span class="n">ds</span> <span class="o">=</span> <span class="n">fwk</span><span class="o">.</span><span class="n">dataSource</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">66</span> 
<span class="g g-Whitespace">     </span><span class="mi">67</span> 

<span class="ne">RuntimeError</span>: IData::Exception: dataset directory is missing: /reg/d/psdm/XPP/xpptut15/xtc/smalldata [in function files at IData/src/Dataset.cpp:367]

<span class="gp">In [3]: </span><span class="n">ds</span><span class="o">.</span><span class="n">configData</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-3-b2bdde492635&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">ds</span><span class="o">.</span><span class="n">configData</span>

<span class="ne">NameError</span>: name &#39;ds&#39; is not defined
</pre></div>
</div>
<p>Get the first event and press tab to see detectors in event (according to aliases defined in daq).</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">evt</span><span class="o">.&lt;</span><span class="n">TAB</span><span class="o">&gt;</span>
<span class="go">         evt.cspad           evt.Evr             evt.keys            evt.PhaseCavity     evt.XppSb3_Ipm</span>
<span class="go">         evt.EBeam           evt.FEEGasDetEnergy evt.L3T             evt.XppEnds_Ipm0    evt.yag2</span>
<span class="go">         evt.EventId         evt.get             evt.next            evt.XppSb2_Ipm      evt.yag_lom</span>
</pre></div>
</div>
</div>
<div class="section" id="calibrated-area-detector">
<h2>Calibrated Area Detector<a class="headerlink" href="#calibrated-area-detector" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>For complex detectors such as the cspad, the detector object gives access to the raw, calibrated and reconstructed images.</dt>
<dd><ul class="first last simple">
<li>raw:    raw uncorrected data (3D array)</li>
<li>calib:  calibrated “unassembled data” (3D array, pedestal and common mode corrected, no geometry applied)</li>
<li>image:  “assembled images” (2D array, geometry applied).</li>
</ul>
</dd>
</dl>
<p>Tab on the evt.cspad object to see the attributes available and use the show_info method to print a summary table.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.&lt;</span><span class="n">TAB</span><span class="o">&gt;</span>
<span class="gp">   ...: </span>            <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">add</span>        <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">epicsData</span>  <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">L3T</span>        <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">set_cmpars</span>
<span class="gp">   ...: </span>            <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">calib</span>      <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">EventId</span>    <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">monitor</span>    <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">shape</span>
<span class="gp">   ...: </span>            <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">calibData</span>  <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">Evr</span>        <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">next</span>       <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">show_all</span>   <span class="o">&gt;</span>
<span class="gp">   ...: </span>            <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">configData</span> <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">evtData</span>    <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">psplots</span>    <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">show_info</span>
<span class="gp">   ...: </span>            <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">detector</span>   <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">image</span>      <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">raw</span>        <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">size</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<p>See example below of plotting an image with the matplotlib plotting library</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyDataSource</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">PyDataSource</span><span class="o">.</span><span class="n">DataSource</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="s1">&#39;xpptut15&#39;</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="mi">54</span><span class="p">)</span>

<span class="n">evt</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./examples/cspad.py">Source code</a>, <a class="reference external" href="./examples/cspad.png">png</a>, <a class="reference external" href="./examples/cspad.hires.png">hires.png</a>, <a class="reference external" href="./examples/cspad.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/cspad.png" src="_images/cspad.png" />
</div>
</div>
<div class="section" id="event-iteration">
<h2>Event Iteration<a class="headerlink" href="#event-iteration" title="Permalink to this headline">¶</a></h2>
<p>One can iterate events from the ds.events object, the evt object, or a detector object.  Each of these are python iterators.</p>
<p>The representation of each of these provides details of the event including the event codes present.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="n">evt</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-6-7843259d71fb&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;ds&#39; is not defined

<span class="gp">In [7]: </span><span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-7-83bcbfe18d91&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined

<span class="gp">In [8]: </span><span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-8-9dc7d62f31b9&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined

<span class="gp">In [9]: </span><span class="k">for</span> <span class="n">evt</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="p">:</span>
<span class="gp">   ...: </span>    <span class="k">print</span> <span class="n">evt</span>
<span class="gp">   ...: </span>    <span class="k">if</span> <span class="n">ds</span><span class="o">.</span><span class="n">_ievent</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
<span class="gp">   ...: </span>        <span class="k">break</span>
<span class="gp">   ...: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-9-578c30a98df6&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="k">for</span> <span class="n">evt</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="p">:</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="k">print</span> <span class="n">evt</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="k">if</span> <span class="n">ds</span><span class="o">.</span><span class="n">_ievent</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>         <span class="k">break</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> 

<span class="ne">NameError</span>: name &#39;ds&#39; is not defined
</pre></div>
</div>
</div>
<div class="section" id="event-codes">
<h2>Event Codes<a class="headerlink" href="#event-codes" title="Permalink to this headline">¶</a></h2>
<p>To check if an event codes is present:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="n">evt</span><span class="o">.</span><span class="n">Evr</span><span class="o">.</span><span class="n">present</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-10-ec87a6014ff7&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span><span class="o">.</span><span class="n">Evr</span><span class="o">.</span><span class="n">present</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined

<span class="gp">In [11]: </span><span class="n">evt</span><span class="o">.</span><span class="n">Evr</span><span class="o">.</span><span class="n">present</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-11-04dc9962d9ad&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span><span class="o">.</span><span class="n">Evr</span><span class="o">.</span><span class="n">present</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined
</pre></div>
</div>
<p>Note that the default is to strictly check if code has same timestamp as the EventId.
Use strict=False keyword to check if code occurred with any timestamp since last event.</p>
</div>
<div class="section" id="beamline-data">
<h2>Beamline Data<a class="headerlink" href="#beamline-data" title="Permalink to this headline">¶</a></h2>
<p>The following Electron and Photon Beam data are generally recorded for all experiments.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">evt</span><span class="o">.</span><span class="n">EBeam</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-12-8f568803c26b&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span><span class="o">.</span><span class="n">EBeam</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined

<span class="gp">In [13]: </span><span class="n">evt</span><span class="o">.</span><span class="n">FEEGasDetEnergy</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-13-c89e9b7de566&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span><span class="o">.</span><span class="n">FEEGasDetEnergy</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined

<span class="gp">In [14]: </span><span class="n">evt</span><span class="o">.</span><span class="n">PhaseCavity</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-14-319900326020&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span><span class="o">.</span><span class="n">PhaseCavity</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined
</pre></div>
</div>
</div>
<div class="section" id="epics-data">
<h2>Epics Data<a class="headerlink" href="#epics-data" title="Permalink to this headline">¶</a></h2>
<p>The LCLS DAQ includes many slowly changing quantities (e.g. voltages, temperatures, motor positions) that are recorded with software called EPICS.  These can either be accessed by aliases or PV name.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="n">ds</span> <span class="o">=</span> <span class="n">PyDataSource</span><span class="o">.</span><span class="n">DataSource</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="s1">&#39;xpptut15&#39;</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="mi">59</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-15-8922bb09f2ce&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">ds</span> <span class="o">=</span> <span class="n">PyDataSource</span><span class="o">.</span><span class="n">DataSource</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="s1">&#39;xpptut15&#39;</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="mi">59</span><span class="p">)</span>

<span class="nn">/reg/neh/home4/koglin/conda/arch/x86_64-rhel7-gcc48-opt/python/PyDataSource/PyDataSource.pyc</span> in <span class="ni">__init__</span><span class="nt">(self, data_source, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">697</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_default_modules</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">path</span><span class="p">})</span>
<span class="g g-Whitespace">    </span><span class="mi">698</span>         <span class="c1">#self._default_modules.update({&#39;path&#39;: os.path.join(path,&#39;detectors&#39;)})</span>
<span class="ne">--&gt; </span><span class="mi">699</span>         <span class="bp">self</span><span class="o">.</span><span class="n">load_run</span><span class="p">(</span><span class="n">data_source</span><span class="o">=</span><span class="n">data_source</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">700</span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">smd</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">701</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_load_smd_config</span><span class="p">()</span>

<span class="nn">/reg/neh/home4/koglin/conda/arch/x86_64-rhel7-gcc48-opt/python/PyDataSource/PyDataSource.pyc</span> in <span class="ni">load_run</span><span class="nt">(self, data_source, reload, try_idx, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">791</span>         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">monshmserver</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ds</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">792</span>             <span class="k">if</span> <span class="bp">True</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">793</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">_ds</span> <span class="o">=</span> <span class="n">psana</span><span class="o">.</span><span class="n">DataSource</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_source</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">794</span>                 <span class="n">_key_info</span><span class="p">,</span> <span class="n">_modules</span> <span class="o">=</span> <span class="n">get_keys</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ds</span><span class="o">.</span><span class="n">env</span><span class="p">()</span><span class="o">.</span><span class="n">configStore</span><span class="p">())</span>
<span class="g g-Whitespace">    </span><span class="mi">795</span>                 <span class="k">if</span> <span class="s1">&#39;Partition&#39;</span> <span class="ow">in</span> <span class="n">_modules</span><span class="p">:</span>

<span class="nn">/reg/g/psdm/sw/conda/inst/miniconda2-prod-rhel7/envs/ana-1.3.11/lib/python2.7/site-packages/psana/datasource.pyc</span> in <span class="ni">DataSource</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span> 
<span class="g g-Whitespace">     </span><span class="mi">64</span>     <span class="c1"># Create the PSANA datasource object</span>
<span class="ne">---&gt; </span><span class="mi">65</span>     <span class="n">ds</span> <span class="o">=</span> <span class="n">fwk</span><span class="o">.</span><span class="n">dataSource</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">66</span> 
<span class="g g-Whitespace">     </span><span class="mi">67</span> 

<span class="ne">RuntimeError</span>: IData::Exception: dataset directory is missing: /reg/d/psdm/XPP/xpptut15/xtc/smalldata [in function files at IData/src/Dataset.cpp:367]

<span class="gp">In [16]: </span><span class="n">evt</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-16-7843259d71fb&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;ds&#39; is not defined

<span class="gp">In [17]: </span><span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.&lt;</span><span class="n">TAB</span><span class="o">&gt;</span>
<span class="gp">   ....: </span>              <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">alias</span>        <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">ccm</span>          <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">CSPAD</span>        <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">filt</span>         <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">hrm1</span>         <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">ipm1</span>
<span class="gp">   ....: </span>              <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">aliases</span>      <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">ccmE</span>         <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">drift</span>        <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">FS3</span>          <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">hrm2</span>         <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">ipm1b</span>
<span class="gp">   ....: </span>              <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">alio</span>         <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">ccmTheta0</span>    <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">epicsConfig</span>  <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">getPV</span>        <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">HX2</span>          <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">ipm2</span>         <span class="o">&gt;</span>
<span class="gp">   ....: </span>              <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">analogOut</span>    <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">ChipAddress</span>  <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">EVR</span>          <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">gon</span>          <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">HX3</span>          <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">ipm3</span>
<span class="gp">   ....: </span>              <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">Be</span>           <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">ChipName</span>     <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">FeeAtt</span>       <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">grid</span>         <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">ipm</span>          <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">ire</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<p>Epics data associated with detectors (using the convention of using an alias starting with the detector name) can be accessed either from the ds.epicsData object or more conveniently from the epicsData object in the detector.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">yag2</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-18-12adf9078605&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">yag2</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;ds&#39; is not defined

<span class="gp">In [19]: </span><span class="n">evt</span><span class="o">.</span><span class="n">yag2</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-19-cdc1a62cdb9b&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span><span class="o">.</span><span class="n">yag2</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined
</pre></div>
</div>
</div>
<div class="section" id="waveform-detectors">
<h2>Waveform Detectors<a class="headerlink" href="#waveform-detectors" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>There are several types of voltage-versus-time (“waveform”) detectors supported:</dt>
<dd><ul class="first last simple">
<li>Acqiris (now “Agilent U1065A”)</li>
<li>‘Imp’ detectors (SLAC).</li>
<li>‘Wave8’ detectors (SLAC).</li>
</ul>
</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyDataSource</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">PyDataSource</span><span class="o">.</span><span class="n">DataSource</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="s1">&#39;xpptut15&#39;</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="mi">280</span><span class="p">)</span>

<span class="n">evt</span>  <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="n">evt</span><span class="o">.</span><span class="n">ACQ1</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">evt</span><span class="o">.</span><span class="n">ACQ1</span><span class="o">.</span><span class="n">wftime</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">evt</span><span class="o">.</span><span class="n">ACQ1</span><span class="o">.</span><span class="n">waveform</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./examples/acqiris.py">Source code</a>, <a class="reference external" href="./examples/acqiris.png">png</a>, <a class="reference external" href="./examples/acqiris.hires.png">hires.png</a>, <a class="reference external" href="./examples/acqiris.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/acqiris.png" src="_images/acqiris.png" />
</div>
<p>NOTE: For Acqiris detectors the user can often find between 0-7 “zeros” at the end of the arrays.  This is because the acqiris will read out 40,000 samples, for example, but the trigger is not necessarily on sample 0: from shot-to-shot it can vary between 0 and 7.</p>
<p>In the above user interface we move the data arrays so the trigger happens on sample 0 (so users can more easily add results from different events, for example). But after we do this, to keep the array sizes constant, we pad the end with zeros. This is not ideal, but it makes the user-interface simpler, which is important for LCLS users.</p>
<p>In this example we use older data that does not have aliases, so the detectors names are generated from their ‘daq’ identifiers.</p>
</div>
<div class="section" id="anlyzing-scans">
<h2>Anlyzing Scans<a class="headerlink" href="#anlyzing-scans" title="Permalink to this headline">¶</a></h2>
<p>Information about daq scans (where things like motor positions are changed during a run in “steps” or “calibcycles”) is accessible from the ds.configData.  The ScanData object may take dozens of seconds to load the first time depending on the length of the scan.  Once loaded you have access to the scan information as lists the length of the number of steps in the scan.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [21]: </span><span class="kn">import</span> <span class="nn">PyDataSource</span>

<span class="gp">In [22]: </span><span class="n">ds</span>  <span class="o">=</span> <span class="n">PyDataSource</span><span class="o">.</span><span class="n">DataSource</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="s1">&#39;xpptut15&#39;</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

<span class="gp">In [23]: </span><span class="o">%</span><span class="k">time</span> ds.configData.ScanData.show_info()
<span class="go">CPU times: user 51.7 s, sys: 2.4 s, total: 54.1 s</span>
<span class="go">Wall time: 50.5 s</span>
<span class="gh">Out[23]:</span>
<span class="go">xpptut15  : Run 200</span>
<span class="gt">----------------------------------------------------------------------</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">steps</span>                  <span class="mi">45</span> <span class="n">nsteps</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">monitor</span> <span class="n">PVs</span>             <span class="mi">0</span> <span class="n">npvMonitors</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">control</span> <span class="n">PVs</span>             <span class="mi">1</span> <span class="n">npvControls</span>

<span class="n">Alias</span>                    <span class="n">PV</span>
<span class="gt">----------------------------------------------------------------------</span>
<span class="n">lxt_vitara_ttc</span>           <span class="n">lxt_vitara_ttc</span>

<span class="n">Step</span> <span class="n">Events</span>   <span class="n">Time</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="n">lxt_vitara_ttc</span>
<span class="gt">-----------------------------------</span>
<span class="g g-Whitespace">   </span><span class="mi">0</span>   <span class="mi">1306</span>   <span class="mf">19.179</span>     <span class="o">-</span><span class="mf">1.000e-12</span>
<span class="g g-Whitespace">   </span><span class="mi">1</span>    <span class="mi">625</span>    <span class="mf">5.207</span>     <span class="o">-</span><span class="mf">7.500e-13</span>
<span class="g g-Whitespace">   </span><span class="mi">2</span>    <span class="mi">629</span>    <span class="mf">5.239</span>     <span class="o">-</span><span class="mf">5.000e-13</span>
<span class="g g-Whitespace">   </span><span class="mi">3</span>    <span class="mi">635</span>    <span class="mf">5.289</span>     <span class="o">-</span><span class="mf">2.500e-13</span>
<span class="g g-Whitespace">   </span><span class="mi">4</span>    <span class="mi">635</span>    <span class="mf">5.289</span>     <span class="o">-</span><span class="mf">8.470e-22</span>
<span class="g g-Whitespace">   </span><span class="mi">5</span>   <span class="mi">3413</span>   <span class="mf">37.788</span>      <span class="mf">2.500e-13</span>
<span class="g g-Whitespace">   </span><span class="mi">6</span>    <span class="mi">623</span>    <span class="mf">5.190</span>      <span class="mf">5.000e-13</span>
<span class="g g-Whitespace">   </span><span class="mi">7</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">7.500e-13</span>
<span class="g g-Whitespace">   </span><span class="mi">8</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">1.000e-12</span>
<span class="g g-Whitespace">   </span><span class="mi">9</span>    <span class="mi">629</span>    <span class="mf">5.241</span>      <span class="mf">1.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">10</span>    <span class="mi">635</span>    <span class="mf">5.290</span>      <span class="mf">1.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">11</span>    <span class="mi">635</span>    <span class="mf">5.291</span>      <span class="mf">1.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">12</span>    <span class="mi">635</span>    <span class="mf">5.291</span>      <span class="mf">2.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">13</span>    <span class="mi">629</span>    <span class="mf">5.241</span>      <span class="mf">2.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">14</span>   <span class="mi">1487</span>   <span class="mf">17.988</span>      <span class="mf">2.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">15</span>    <span class="mi">623</span>    <span class="mf">5.190</span>      <span class="mf">2.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">16</span>    <span class="mi">623</span>    <span class="mf">5.189</span>      <span class="mf">3.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">17</span>    <span class="mi">623</span>    <span class="mf">5.190</span>      <span class="mf">3.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">18</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">3.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">19</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">3.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">20</span>    <span class="mi">637</span>    <span class="mf">5.306</span>      <span class="mf">4.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">21</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">4.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">22</span>    <span class="mi">777</span>    <span class="mf">6.473</span>      <span class="mf">4.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">23</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">4.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">24</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">5.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">25</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">5.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">26</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">5.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">27</span>    <span class="mi">629</span>    <span class="mf">5.239</span>      <span class="mf">5.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">28</span>    <span class="mi">629</span>    <span class="mf">5.239</span>      <span class="mf">6.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">29</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">6.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">30</span>    <span class="mi">629</span>    <span class="mf">5.241</span>      <span class="mf">6.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">31</span>    <span class="mi">629</span>    <span class="mf">5.241</span>      <span class="mf">6.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">32</span>    <span class="mi">623</span>    <span class="mf">5.191</span>      <span class="mf">7.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">33</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">7.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">34</span>    <span class="mi">623</span>    <span class="mf">5.191</span>      <span class="mf">7.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">35</span>   <span class="mi">1361</span>   <span class="mf">11.340</span>      <span class="mf">7.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">36</span>    <span class="mi">767</span>    <span class="mf">6.388</span>      <span class="mf">8.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">37</span>    <span class="mi">899</span>    <span class="mf">7.488</span>      <span class="mf">8.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">38</span>   <span class="mi">1037</span>    <span class="mf">8.640</span>      <span class="mf">8.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">39</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">8.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">40</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">9.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">41</span>    <span class="mi">623</span>    <span class="mf">5.190</span>      <span class="mf">9.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">42</span>    <span class="mi">623</span>    <span class="mf">5.190</span>      <span class="mf">9.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">43</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">9.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">44</span>    <span class="mi">629</span>    <span class="mf">5.241</span>      <span class="mf">1.000e-11</span>
</pre></div>
</div>
<p>Here is a quick way to iterate over steps:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [24]: </span> <span class="k">for</span> <span class="n">istep</span><span class="p">,</span> <span class="n">stepevts</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">steps</span><span class="p">):</span>
<span class="go">    ...:     evt = stepevts.next()</span>
<span class="go">    ...:     print istep, evt</span>
<span class="go">    ...:</span>
<span class="go">0 xpptut15, Run 200, Step 0, Event 0, 07:17:55.8309, [141, 90, 40, 41, 140]</span>
<span class="go">1 xpptut15, Run 200, Step 1, Event 0, 07:18:17.5429, [141, 142, 91, 40, 41, 42, 140]</span>
<span class="go">2 xpptut15, Run 200, Step 2, Event 0, 07:18:25.0651, [90, 40, 140]</span>
<span class="go">3 xpptut15, Run 200, Step 3, Event 0, 07:18:32.9365, [60, 141, 142, 91, 40, 41, 42, 140]</span>
<span class="go">4 xpptut15, Run 200, Step 4, Event 0, 07:18:40.8244, [90, 40, 140]</span>
<span class="go">...</span>
</pre></div>
</div>
</div>
<div class="section" id="reloading-datasource">
<h2>Reloading DataSource<a class="headerlink" href="#reloading-datasource" title="Permalink to this headline">¶</a></h2>
<p>Use the reload method to start back at the beginning of a run.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">ds</span><span class="o">.</span><span class="n">reload</span><span class="p">()</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-20-ade9c3734bee&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">ds</span><span class="o">.</span><span class="n">reload</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;ds&#39; is not defined

<span class="gp">In [21]: </span><span class="n">evt</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-21-7843259d71fb&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;ds&#39; is not defined

<span class="gp">In [22]: </span><span class="n">evt</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-22-4d0510652b08&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined

<span class="gp">In [23]: </span><span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-23-83bcbfe18d91&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined
</pre></div>
</div>
</div>
<div class="section" id="jump-quickly-to-specific-event">
<h2>Jump Quickly to Specific Event<a class="headerlink" href="#jump-quickly-to-specific-event" title="Permalink to this headline">¶</a></h2>
<p>Time stamps can be used to jump to specific event in the next method.  Alternatively an interger event number can be supplied to goto event number in DataSource (although it may not be exactly same event depending on how the data_source string is corresponding keywords to define the data_source is defined and also may differ for fast feedback and offline analysis environments).</p>
<p>This example shows jumping to event 200, saving the EventTime, going back to event 0, and then using the saved EventTime to jump back to event 200.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [24]: </span><span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-24-83bcbfe18d91&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined

<span class="gp">In [25]: </span><span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-25-93da261b27be&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined

<span class="gp">In [26]: </span><span class="n">et200</span> <span class="o">=</span> <span class="n">evt</span><span class="o">.</span><span class="n">EventId</span><span class="o">.</span><span class="n">EventTime</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-26-8813fbcf1e44&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">et200</span> <span class="o">=</span> <span class="n">evt</span><span class="o">.</span><span class="n">EventId</span><span class="o">.</span><span class="n">EventTime</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined

<span class="gp">In [27]: </span><span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-27-f5501a1f6700&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined

<span class="gp">In [28]: </span><span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">et200</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-28-0d64e003393d&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">et200</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined
</pre></div>
</div>
<p>If nothing is passed in the next method, then the next event goes to the next event before we started jumping to specific events.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [29]: </span><span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-29-83bcbfe18d91&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;evt&#39; is not defined
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="data_processing.html" class="btn btn-neutral float-right" title="Data Processing" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to PyDataSource’s documentation!" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, SLAC National Accelerator Laboratory.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>